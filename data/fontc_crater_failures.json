{
  "_metadata": {
    "description": "Analysis of 17 fontc_crater target discovery failures",
    "data_source": "https://googlefonts.github.io/fontc_crater/ report + investigation of repos at /mnt/shared/upstream_repos/fontc_crater_cache/",
    "generated": "2026-02-19",
    "total_failures": 17,
    "categories": {
      "prebuild_script_needed": 6,
      "path_resolution_bugs": 3,
      "stale_cache_wrong_branch": 4,
      "incompatible_build_system": 2,
      "stale_crater_result": 1,
      "inline_recipe_generated": 1
    }
  },
  "failures": {
    "prebuild_script_needed": {
      "description": "Source files are generated by pre-build scripts (build.sh, Makefile targets) that must run before gftools-builder can find them.",
      "fix_strategy": "fontc_crater should run each repo's build.sh/Makefile prep targets before attempting source discovery. Alternatively, repos need preCompile support in config.yaml.",
      "repos": [
        {
          "repo": "Gue3bara/Cairo",
          "error": "missing source 'CairoPlay.glyphs'",
          "missing_file": "CairoPlay.glyphs",
          "file_exists": false,
          "root_cause": "CairoPlay.glyphs is generated at build time by scripts/makeplay.py from Cairo.glyphs. build.sh runs the script, then deletes the file after build.",
          "fix_command": "python3 scripts/makeplay.py sources/Cairo.glyphs sources/CairoPlay.glyphs",
          "actual_source": "sources/Cairo.glyphs (exists, 25MB)"
        },
        {
          "repo": "MoonlitOwen/CactusSerif",
          "error": "missing source 'temp/CactusClassicalSerif-Regular.ufo'",
          "missing_file": "temp/CactusClassicalSerif-Regular.ufo",
          "file_exists": false,
          "root_cause": "UFO is extracted from .ufoz (zipped UFO) archive by scripts/extract.py, then processed by fcp_ufo_process.py (fixes BOM encoding, fontinfo, features from Font Creator 15 output).",
          "fix_command": "mkdir source/temp && python3 source/scripts/extract.py && python3 source/fcp_ufo_process.py",
          "actual_source": "source/CactusClassicalSerif-Regular.ufoz"
        },
        {
          "repo": "MoonlitOwen/ChocolateSans",
          "error": "missing source 'temp/ChocolateClassicalSans-Regular.ufo'",
          "missing_file": "temp/ChocolateClassicalSans-Regular.ufo",
          "file_exists": false,
          "root_cause": "Same pattern as CactusSerif. UFO extracted from .ufoz then processed.",
          "fix_command": "mkdir source/temp && python3 source/scripts/extract.py && python3 source/fcp_ufo_process.py",
          "actual_source": "source/ChocolateClassicalSans-Regular.ufoz"
        },
        {
          "repo": "MoonlitOwen/ThenKhung",
          "error": "missing source 'temp/UoqMunThenKhung-Regular.ufo'",
          "missing_file": "temp/UoqMunThenKhung-Regular.ufo",
          "file_exists": false,
          "root_cause": "Same pattern as CactusSerif. UFO extracted from .ufoz then processed.",
          "fix_command": "mkdir source/temp && python3 source/scripts/extract.py && python3 source/fcp_ufo_process.py",
          "actual_source": "source/UoqMunThenKhung-Regular.ufoz"
        },
        {
          "repo": "aaronbell/LxgwMarkerGothic",
          "error": "missing source 'temp/LXGWMarkerGothic-Regular.ufo'",
          "missing_file": "temp/LXGWMarkerGothic-Regular.ufo",
          "file_exists": false,
          "root_cause": "Same .ufoz extraction pattern. Makefile extract target runs python3 sources/scripts/extract.py.",
          "fix_command": "python3 sources/scripts/extract.py",
          "actual_source": "sources/LXGWMarkerGothic-Regular.ufoz"
        },
        {
          "repo": "loudifier/Comic-Relief",
          "error": "missing source 'ComicRelief-Bold.ufo'",
          "missing_file": "ComicRelief-Bold.ufo",
          "file_exists": false,
          "root_cause": "UFO must be converted from FontForge .sfd file using sfd2ufo. Makefile has a separate 'convert' target that is not run automatically by the 'build' target.",
          "fix_command": "for sfd in sources/*.sfd; do sfd2ufo $sfd ${sfd%%.*}.ufo; done",
          "actual_source": "sources/ComicRelief-Bold.sfd"
        }
      ]
    },
    "path_resolution_bugs": {
      "description": "Source files exist in the repo but fontc_crater's auto-discovery generates incorrect paths. These are bugs in fontc_crater, not in the repos.",
      "fix_strategy": "Fix fontc_crater's auto-discovery logic: handle source/ vs sources/ directory names, repos without config.yaml, and monorepos with multiple config files.",
      "repos": [
        {
          "repo": "alexeiva/Arsenal",
          "error": "missing source 'Arsenal-Italic.glyphs'",
          "missing_file": "Arsenal-Italic.glyphs",
          "file_exists": true,
          "file_actual_path": "sources/Arsenal-Italic.glyphs (1.49MB)",
          "root_cause": "No config.yaml exists in this repo. fontc_crater auto-generates a config but resolves the path incorrectly (missing sources/ prefix or wrong working directory)."
        },
        {
          "repo": "theleagueof/raleway",
          "error": "missing source 'source/Raleway-Italic.designspace'",
          "missing_file": "source/Raleway-Italic.designspace",
          "file_exists": true,
          "file_actual_path": "sources/Raleway-Italic.designspace (30KB)",
          "root_cause": "No config.yaml exists. fontc_crater auto-discovery uses 'source/' (no s) instead of the actual directory name 'sources/' (with s)."
        },
        {
          "repo": "xotypeco/big_shoulders",
          "error": "missing source '../Big-Shoulders/sources/BigShoulders.glyphs'",
          "missing_file": "../Big-Shoulders/sources/BigShoulders.glyphs",
          "file_exists": true,
          "file_actual_path": "Big-Shoulders/sources/BigShoulders.glyphs",
          "root_cause": "Monorepo with 3 sub-families (Big-Shoulders/, Big-Shoulders-Inline/, Big-Shoulders-Stencil/), each with their own config.yml. fontc_crater generates a cross-directory relative path that doesn't match any config file. All .glyphs files exist in their respective directories."
        }
      ]
    },
    "stale_cache_wrong_branch": {
      "description": "The git commit referenced in METADATA.pb cannot be found in the local cache, either because the cache is stale, the wrong branch was cloned, or the commit is on a non-default branch.",
      "fix_strategy": "Respect METADATA.pb branch field when cloning. Fetch all branches (or at least the one specified). Re-fetch stale caches.",
      "repos": [
        {
          "repo": "balt-dev/bytesized-gf",
          "error": "could not find commit '11abbf2db0602d93f35ec9d493a074e384f0cdb3'",
          "commit_exists": true,
          "root_cause": "False alarm. Commit exists in cache — HEAD is detached at it. Likely a transient error during the fontc_crater run.",
          "cache_state": "HEAD detached at the exact commit. Commit is ancestor of main (10a6337)."
        },
        {
          "repo": "chiron-fonts/chiron-hei-hk",
          "error": "could not find commit '5d80c2cecb7d0d702c23b4caa71e524b030d99d5'",
          "commit_exists": false,
          "root_cause": "Wrong branch cloned. METADATA.pb says branch: 'source' but cache only has the 'release' branch (repo default). The 'source' branch was never fetched.",
          "cache_state": "Only 'release' branch present (tip: 644579bd). Remote 'source' branch exists (ef054c54c) but was never fetched.",
          "fix": "Fetch the 'source' branch: git fetch origin source"
        },
        {
          "repo": "googlefonts/gidugu",
          "error": "could not find commit '834c5de1862debc558e536377bc3ebc1c35bf958'",
          "commit_exists": true,
          "root_cause": "Commit exists on origin/main but cache HEAD is on master. Repo has two branches (master and main), commit is on the non-default one. After Jan 30, 2026 fetch, the object is present.",
          "cache_state": "HEAD on master (84b69c2). Commit 834c5de is tip of origin/main. Both branches now fetched.",
          "fix": "Use git checkout or git cat-file that searches all branches, not just HEAD"
        },
        {
          "repo": "notofonts/khojki",
          "error": "could not find commit '02e25bf94664812076be4fa7dd1d688641e4bf8a'",
          "commit_exists": false,
          "root_cause": "Cache is stale. Last fetched Sep 15, 2025. Commit was pushed to upstream after that date. This is for Noto Serif Khojki; Noto Sans Khojki's commit (85ad2f40) does exist in the cache.",
          "cache_state": "main branch tip is 87bad76 (Jun 18, 2025). Commit 02e25bf9 not in history.",
          "fix": "Re-fetch: git fetch origin"
        }
      ]
    },
    "incompatible_build_system": {
      "description": "Repos that use entirely custom build systems, not gftools-builder. The config.yaml is either misleading boilerplate or deliberately minimal.",
      "fix_strategy": "Exclude from fontc_crater testing or flag as 'custom build — not gftools-builder compatible'.",
      "repos": [
        {
          "repo": "notofonts/duployan",
          "error": "missing source 'NotoSansDuployan.glyphs'",
          "missing_file": "NotoSansDuployan.glyphs",
          "file_exists": false,
          "root_cause": "Font is built entirely from Python code via sources/build.py using FontForge API. No .glyphs file exists or will ever exist. The config.yaml (recipeProvider: noto) is misleading boilerplate from the notofonts template — the actual build never uses it.",
          "build_system": "Custom Python + FontForge (sources/build.py, duployan.py, shapes.py)"
        },
        {
          "repo": "petrvanblokland/TYPETR-Bitcount",
          "error": "missing field `sources`",
          "missing_file": null,
          "file_exists": false,
          "root_cause": "config.yaml only contains 'familyName: Bitcount'. Uses a custom Makefile + scripts/build.py with hardcoded designspaces and fontmake calls. Never uses gftools-builder at all. The config.yaml is just metadata for the Makefile's read-config.py helper.",
          "build_system": "Custom Makefile + scripts/build.py with 16 UFO masters, COLRv1 color layers"
        }
      ]
    },
    "stale_crater_result": {
      "description": "The fontc_crater run was against an older commit where the source path was different. The current HEAD has the correct sources.",
      "fix_strategy": "Re-fetch and re-test against current HEAD.",
      "repos": [
        {
          "repo": "mooniak/abhaya-libre-font",
          "error": "missing source 'sources/glyphs/Abhaya-Masters.glyphs'",
          "missing_file": "sources/glyphs/Abhaya-Masters.glyphs",
          "file_exists": false,
          "root_cause": "Old path from before repo was reorganized (template migration). Current HEAD has sources/AbhayaLibre.glyphs which exists (3.1MB). The config.yaml now correctly references AbhayaLibre.glyphs.",
          "current_source": "sources/AbhayaLibre.glyphs (exists)",
          "fix": "Re-test against current HEAD commit"
        }
      ]
    },
    "inline_recipe_generated": {
      "description": "The source file is generated by an exec step within the gftools recipe itself, not by a pre-build script. fontc_crater fails because it checks source existence before running the recipe.",
      "fix_strategy": "fontc_crater should understand that exec recipe steps can generate intermediate files, or skip source validation for custom recipes.",
      "repos": [
        {
          "repo": "googlefonts/sawarabi-mincho",
          "error": "missing source 'SawarabiMincho.glyphs'",
          "missing_file": "SawarabiMincho.glyphs",
          "file_exists": false,
          "root_cause": "The config uses a custom recipe where a babelfont exec operation converts fonts/mincho/sawarabi-mincho-medium.sfdir to SawarabiMincho.glyphs as an intermediate step. The sources: field lists SawarabiMincho.glyphs as the nominal source, but the actual starting source is the .sfdir file.",
          "actual_source": "fonts/mincho/sawarabi-mincho-medium.sfdir",
          "recipe_step": "exec: babelfont $in SawarabiMincho.glyphs"
        }
      ]
    }
  }
}
